{
  "types": [
    { "id":400, "name":"ChannelSftp", "color":"brown" },
    { "id":401, "name":"ChannelSftp.LsEntry", "color":"orange" } 
    ],
  "nodes": [
    {
      "name": "SFTP Connect",
      "type": 4,
      "version": 1,
      "import": ["com.jcraft.jsch.ChannelSftp", "com.jcraft.jsch.JSch", "com.jcraft.jsch.JSchException", "com.jcraft.jsch.Session", "com.jcraft.jsch.SftpException"],
      "jar": ["{path}/jsch-0.1.55.jar"],
      "java": "@Connect.java",
      "input": [
        { "type": "Exec", "label": "" },
        { "type": "String", "label": "Host", "value": "localhost", "single_line":true },
        { "type": "Integer", "label": "Port", "value": 22 },
        { "type": "String", "label": "User", "value": "", "single_line":true },
        { "type": "Integer", "label": "Auth", "value": 0, "enum": [ "Password", "Public key" ] },
        { "type": "String", "label": "Password", "value": "", "password": true, "single_line":true }
      ],
      "output": [
        { "type": "Exec", "label": "Success" },
        { "type": "ChannelSftp", "label": "Channel", "java": {"references": {"variable":"channel"}} },
        { "type": "Exec", "label": "Error" },
        { "type": "String", "label": "Message", "java": {"references": {"variable":"msg"}} }
      ]
    },
    {
      "name": "SFTP Disconnect",
      "type": 4,
      "version": 1,
      "import": ["com.jcraft.jsch.ChannelSftp", "com.jcraft.jsch.JSch", "com.jcraft.jsch.JSchException", "com.jcraft.jsch.Session", "com.jcraft.jsch.SftpException"],
      "jar": ["{path}/jsch-0.1.55.jar"],
      "java": "try { in{1}.disconnect(); in{1}.getSession().disconnect(); } catch(JSchException e) { }",
      "input": [
        { "type": "Exec", "label": "" },
        { "type": "ChannelSftp", "label": "Channel" }
      ],
      "output": [
        { "type": "Exec", "label": "" },
      ]
    },
    {
      "name": "SFTP Put",
      "type": 4,
      "version": 1,
      "import": ["com.jcraft.jsch.ChannelSftp", "com.jcraft.jsch.JSch", "com.jcraft.jsch.JSchException", "com.jcraft.jsch.Session", "com.jcraft.jsch.SftpException"],
      "jar": ["{path}/jsch-0.1.55.jar"],
      "java": "@Put.java",
      "input": [
        { "type": "Exec", "label": "" },
        { "type": "ChannelSftp", "label": "Channel" },
        { "type": "String", "label": "Local file", "value": "", "single_line":true },
        { "type": "String", "label": "Remote file", "value": "", "single_line":true }
      ],
      "output": [
        { "type": "Exec", "label": "Success" },
        { "type": "ChannelSftp", "label": "Channel", "java": {"references": {"input":1}} },
        { "type": "Exec", "label": "Error" },
        { "type": "String", "label": "Message", "java": {"references": {"variable":"msg"}} }
      ]
    },
    {
      "name": "SFTP Get",
      "type": 4,
      "version": 1,
      "import": ["com.jcraft.jsch.ChannelSftp", "com.jcraft.jsch.JSch", "com.jcraft.jsch.JSchException", "com.jcraft.jsch.Session", "com.jcraft.jsch.SftpException"],
      "jar": ["{path}/jsch-0.1.55.jar"],
      "java": "@Get.java",
      "input": [
        { "type": "Exec", "label": "" },
        { "type": "ChannelSftp", "label": "Channel" },
        { "type": "String", "label": "Remote file", "value": "", "single_line":true },
        { "type": "String", "label": "Local file", "value": "", "single_line":true }
      ],
      "output": [
        { "type": "Exec", "label": "Success" },
        { "type": "ChannelSftp", "label": "Channel", "java": {"references": {"input":1}} },
        { "type": "Exec", "label": "Error" },
        { "type": "String", "label": "Message", "java": {"references": {"variable":"msg"}} }
      ]
    },
    {
      "name": "SFTP Rename",
      "type": 4,
      "version": 1,
      "import": ["com.jcraft.jsch.ChannelSftp", "com.jcraft.jsch.JSch", "com.jcraft.jsch.JSchException", "com.jcraft.jsch.Session", "com.jcraft.jsch.SftpException"],
      "jar": ["{path}/jsch-0.1.55.jar"],
      "java": "boolean _{node.id}_renameOK = true; try { in{1}.rename(in{2}, in{3}); } catch(SftpException e) { out{3} = \"SFTP Rename: \"+e.getMessage(); _{node.id}_renameOK = false; } if (_{node.id}_renameOK) { exec{0} } else { exec{2} }",
      "input": [
        { "type": "Exec", "label": "" },
        { "type": "ChannelSftp", "label": "Channel" },
        { "type": "String", "label": "Current name", "value": "", "single_line":true },
        { "type": "String", "label": "New name", "value": "", "single_line":true }
      ],
      "output": [
        { "type": "Exec", "label": "Success" },
        { "type": "ChannelSftp", "label": "Channel", "java": {"references": {"input":1}} },
        { "type": "Exec", "label": "Error" },
        { "type": "String", "label": "Message", "java": {"references": {"variable":"msg"}} }
      ]
    },
    {
      "name": "SFTP List",
      "type": 4,
      "version": 1,
      "import": ["java.lang.ArrayStoreException", "java.util.Vector", "com.jcraft.jsch.ChannelSftp", "com.jcraft.jsch.JSch", "com.jcraft.jsch.JSchException", "com.jcraft.jsch.Session", "com.jcraft.jsch.SftpException"],
      "jar": ["{path}/jsch-0.1.55.jar"],
      "java": "@List.java",
      "input": [
        { "type": "Exec", "label": "" },
        { "type": "ChannelSftp", "label": "Channel" },
        { "type": "String", "label": "Path", "value": "", "single_line":true }
      ],
      "output": [
        { "type": "Exec", "label": "Success" },
        { "type": "ChannelSftp", "label": "Channel", "java": {"references": {"input":1}} },
        { "type": "ChannelSftp.LsEntry", "label": "List", "dimensions":1, "java": {"references": {"variable":"ls"}} },
        { "type": "Exec", "label": "Error" },
        { "type": "String", "label": "Message", "java": {"references": {"variable":"msg"}} }
      ]
    },
    {
      "name": "SFTP Get Filename",
      "type": 5,
      "version": 1,
      "import": ["com.jcraft.jsch.JSch", "com.jcraft.jsch.JSchException", "com.jcraft.jsch.Session", "com.jcraft.jsch.SftpException"],
      "jar": ["{path}/jsch-0.1.55.jar"],
      "java": "in{0}.getFilename()",
      "input": [
        { "type": "ChannelSftp.LsEntry", "label": "LsEntry" }
      ],
      "output": [
        { "type": "String", "label": "Filename" }
      ]
    }
  ]
}

