<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>JLogic</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Exo">
<link rel='stylesheet' href='css/jlogic.css'>

<script src="js/utils.js"></script>
</head>

<body>
  <!-- Header -->
  <div w3-include-html="header.html"></div>

  <div class="w3-container w3-myFont" style="margin-top:3em; margin-left:10%; margin-right:10%">

    <h2 class="w3-myFont">Download</h2>
    <hr>

    <div id="list"></div>

    <!------------------------------------------------------------------------------->

    <div class="w3-center w3-margin w3-text-gray">Copyright &copy; 2020 Fabio Leone</div>  </div>
  </div>

  <script>
    'use strict';

    includeHTML();

    var listElem = document.getElementById("list");

    callServer ("GET", "https://api.github.com/repos/FabLeo451/JLogic/releases", null, function (xhttp) {
        if (xhttp.readyState == 4) {
          if (xhttp.status == 200) {
            listElem.innerHTML = "";
            var ja = JSON.parse(xhttp.responseText);

            for (var i=0; i<ja.length; i++) {
              var jrelease = ja[i];
              var item = document.createElement('div');
              item.classList.add('w3-container');
              item.classList.add('w3-round-small');
              item.classList.add('w3-light-gray');
           
              item.innerHTML = `<div class="w3-large"><b>`+jrelease.name+`</b></div>
                                <div class="w3-section">`+jrelease.body+`</div>
                                <table class="w3-table" style="width:50%;">
                                  <tr><td>Link</td><td><a href="`+jrelease.assets[0].browser_download_url+`"><b>`+jrelease.assets[0].name+`</b></a></td><tr>
                                  <tr><td>Published</td><td>`+jrelease.published_at+`</td><tr>
                                  <tr><td>Size</td><td>`+(jrelease.assets[0].size/1024/1024).toFixed(1)+`MB</td><tr>
                                  <tr><td>Downloads</td><td>`+jrelease.assets[0].download_count+`</td><tr>
                                </table>
                               `;

              listElem.appendChild(item);
            }
          }
          else {
            listElem.innerHTML = xhttp.statusText;
          }
        }
        else if (xhttp.readyState == 3) { // Processing request
          listElem.innerHTML = "Getting data...";
        }
        else {
          listElem.innerHTML = xhttp.statusText;
        }
      }
    );
  </script>

</body>
</html>
